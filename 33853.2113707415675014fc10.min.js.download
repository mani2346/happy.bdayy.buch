"use strict";(globalThis.webpackChunkcalypso=globalThis.webpackChunkcalypso||[]).push([[33853],{"./lib/plugins/constants.js":(e,t,s)=>{s.d(t,{QY:()=>n,Xl:()=>r,Yg:()=>o,m8:()=>u,ou:()=>a,p5:()=>c,qt:()=>i,t2:()=>p,v7:()=>l});let a="INSTALL_PLUGIN",r="REMOVE_PLUGIN",i="UPDATE_PLUGIN",n="ACTIVATE_PLUGIN",c="DEACTIVATE_PLUGIN",l="ENABLE_AUTOUPDATE_PLUGIN",u="DISABLE_AUTOUPDATE_PLUGIN",o="PLUGIN_UPLOAD",p="RECEIVE_PLUGINS"},"./state/analytics/actions/with-analytics.js":(e,t,s)=>{s.d(t,{J:()=>i});let a=(e,t)=>[...e.meta?.analytics??[],...t.meta?.analytics??[]],r=(e,t)=>"function"==typeof t?s=>{s(e),s(t)}:{...t,meta:{...t.meta,analytics:a(e,t)}};function i(e,t){return void 0===t?t=>r(e,t):r(e,t)}},"./state/automated-transfer/actions.js":(e,t,s)=>{s.d(t,{OD:()=>U,el:()=>j,dL:()=>N,ZR:()=>w,Um:()=>R,VS:()=>C});var a=s("./state/action-types.ts"),r=s("../node_modules/lodash-es/get.js"),i=s("../node_modules/lodash-es/isEmpty.js"),n=s("../node_modules/lodash-es/map.js"),c=s("./state/analytics/actions/record.js"),l=s("./state/analytics/actions/with-analytics.js"),u=s("./state/automated-transfer/constants.ts"),o=s("./state/data-layer/handler-registry.js"),p=s("./state/data-layer/wpcom-http/actions.js"),d=s("./state/data-layer/wpcom-http/utils.js"),g=s("./state/selectors/is-unlaunched-site.js");let _={blocked_atomic_transfer:u.Og.BLOCKED_ATOMIC_TRANSFER,transfer_already_exists:u.Og.TRANSFER_ALREADY_EXISTS,no_business_plan:u.Og.NO_BUSINESS_PLAN,no_jetpack_sites:u.Og.NO_JETPACK_SITES,no_vip_sites:u.Og.NO_VIP_SITES,site_private:u.Og.SITE_PRIVATE,site_graylisted:u.Og.SITE_GRAYLISTED,non_admin_user:u.Og.NON_ADMIN_USER,not_resolving_to_wpcom:u.Og.NOT_RESOLVING_TO_WPCOM,no_ssl_certificate:u.Og.NO_SSL_CERTIFICATE,email_unverified:u.Og.EMAIL_UNVERIFIED,excessive_disk_space:u.Og.EXCESSIVE_DISK_SPACE,is_staging_blog:u.Og.IS_STAGING_SITE},y=({errors:e=[]},t={})=>e.map(({code:e})=>t.sitePrivateUnlaunched&&"site_private"===e?u.Og.SITE_UNLAUNCHED:(0,r.A)(_,e,"")).filter(Boolean),E=({warnings:e={}})=>Object.keys(e).reduce((t,s)=>t.concat(e[s]),[]).map(({description:e,name:t,support_url:s,id:a,domain_names:r})=>({id:a,name:t,description:e,supportUrl:s,domainNames:r})),I=(e,t={})=>({lastUpdate:Date.now(),eligibilityHolds:y(e,t),eligibilityWarnings:E(e)}),O=e=>{let t=(0,r.A)(e,"is_eligible",!1),s=(0,r.A)(e,"warnings.plugins",[]),a=(0,r.A)(e,"warnings.widgets",[]),l=!((0,i.A)(s)&&(0,i.A)(a)),u={has_warnings:l,plugins:(0,n.A)(s,"id").join(","),widgets:(0,n.A)(a,"id").join(",")};return t?(0,c.Oy)("calypso_automated_transfer_eligibility_eligible",u):(u.holds=y(e).join(","),(0,c.Oy)("calypso_automated_transfer_eligibility_ineligible",u))};(0,o.vZ)("state/data-layer/wpcom/sites/automated-transfer/eligibility/index.js",{[a.NK5]:[(0,d.wH)({fetch:e=>(0,p.L)({method:"GET",path:`/sites/${e.siteId}/automated-transfers/eligibility`,apiVersion:"1"},e),onSuccess:({siteId:e},t)=>(s,a)=>{let r=(0,g.A)(a(),e);s((0,l.J)(O(t),C(e,I(t,{sitePrivateUnlaunched:r}))))},onError:()=>{}})]});var m=s("../packages/i18n-calypso/src/index.js"),T=s("./state/notices/actions.ts"),f=s("./state/plugins/upload/actions.js");let S=e=>"invalid_input"===e.error?(0,T.tg)((0,m.Tl)("The uploaded file is not a valid zip.")):"api_success_false"===e.error?(0,T.tg)((0,m.Tl)("The uploaded file is not a valid plugin.")):e.error?(0,T.tg)((0,m.Tl)("Upload problem: %(error)s.",{args:{error:e.error}})):(0,T.tg)((0,m.Tl)("Problem uploading the plugin.")),h=({siteId:e},t)=>[(0,c.Oy)("calypso_automated_transfer_inititate_failure",{context:"plugin_upload",error:t.error}),S(t),(0,f.Zp)(e,t)];(0,o.vZ)("state/data-layer/wpcom/sites/automated-transfer/initiate/index.js",{[a.o7s]:[(0,d.wH)({fetch:e=>{let{siteId:t,pluginZip:s}=e;return[(0,c.Oy)("calypso_automated_transfer_inititate_transfer",{context:"plugin_upload"}),(0,p.L)({method:"POST",path:`/sites/${t}/automated-transfers/initiate`,apiVersion:"1",formData:[["plugin_zip",s],["context","plugin_upload"]]},e)]},onSuccess:(e,{success:t})=>!1===t?h(e,{error:"api_success_false"}):[(0,c.Oy)("calypso_automated_transfer_inititate_success",{context:"plugin_upload"}),j(e.siteId)],onError:h,onProgress:({siteId:e},{loaded:t,total:s})=>(0,f.VW)(e,s?t/s*100:0)})]});var A=s("../node_modules/lodash-es/delay.js"),b=s("./state/sites/actions.js");(0,o.vZ)("state/data-layer/wpcom/sites/automated-transfer/status/index.js",{[a.C3f]:[(0,d.wH)({fetch:e=>(0,p.L)({method:"GET",path:`/sites/${e.siteId}/automated-transfers/status`,apiVersion:"1"},e),onSuccess:({siteId:e},{status:t,uploaded_plugin_slug:s})=>a=>{a(R(e,t,s)),t!==u.qC.ERROR&&t!==u.qC.COMPLETE&&(0,A.A)(a,3e3,j(e)),t===u.qC.COMPLETE&&a((0,b.lC)(e))},onError:e=>U({siteId:e.siteId,error:e.meta?.dataLayer?.error?.message})})]}),s("./state/automated-transfer/init.js");let N=(e,t)=>({type:a.o7s,siteId:e,pluginZip:t}),j=e=>({type:a.C3f,siteId:e}),R=(e,t,s)=>({type:a.Xme,siteId:e,status:t,uploadedPluginId:s}),U=({siteId:e,error:t})=>({type:a.z2q,siteId:e,error:t}),w=e=>({type:a.NK5,siteId:e}),C=(e,{eligibilityHolds:t,eligibilityWarnings:s,lastUpdate:r,status:i})=>({type:a.hGY,eligibilityHolds:t,eligibilityWarnings:s,lastUpdate:r,siteId:e,status:i})},"./state/automated-transfer/constants.ts":(e,t,s)=>{s.d(t,{C3:()=>r,MF:()=>i,Og:()=>n,qC:()=>a});let a={NONE:"none",PENDING:"pending",INQUIRING:"inquiring",PROVISIONED:"provisioned",FAILURE:"failure",START:"start",SETUP:"setup",CONFLICTS:"conflicts",ACTIVE:"active",UPLOADING:"uploading",BACKFILLING:"backfilling",RELOCATING:"relocating_switcheroo",COMPLETE:"complete",COMPLETED:"completed",NULL:null,REVERTED:"reverted",RELOCATING_REVERT:"relocating_revert",ERROR:"error",REQUEST_FAILURE:"request_failure"},r=[a.START,a.PENDING,a.ACTIVE,a.PROVISIONED],i=[a.RELOCATING_REVERT],n={BLOCKED_ATOMIC_TRANSFER:"BLOCKED_ATOMIC_TRANSFER",TRANSFER_ALREADY_EXISTS:"TRANSFER_ALREADY_EXISTS",NO_BUSINESS_PLAN:"NO_BUSINESS_PLAN",NO_JETPACK_SITES:"NO_JETPACK_SITES",NO_VIP_SITES:"NO_VIP_SITES",SITE_PRIVATE:"SITE_PRIVATE",SITE_UNLAUNCHED:"SITE_UNLAUNCHED",SITE_GRAYLISTED:"SITE_GRAYLISTED",NON_ADMIN_USER:"NON_ADMIN_USER",NOT_RESOLVING_TO_WPCOM:"NOT_RESOLVING_TO_WPCOM",NO_SSL_CERTIFICATE:"NO_SSL_CERTIFICATE",EMAIL_UNVERIFIED:"EMAIL_UNVERIFIED",EXCESSIVE_DISK_SPACE:"EXCESSIVE_DISK_SPACE",IS_STAGING_SITE:"IS_STAGING_SITE"}},"./state/automated-transfer/init.js":(e,t,s)=>{var a=s("./state/redux-store.ts"),r=s("../packages/state-utils/src/index.ts"),i=s("./state/action-types.ts"),n=s("./state/themes/action-types.js"),c=s("./state/utils/with-persistence.ts"),l=s("./state/utils/reducer-utils.ts"),u=s("./state/utils/schema-utils.js"),o=s("./state/utils/keyed-reducer.ts"),p=s("./state/automated-transfer/constants.ts"),d=s("../node_modules/lodash-es/sortBy.js"),g=s("../node_modules/lodash-es/property.js");let _={eligibilityHolds:[],eligibilityWarnings:[],lastUpdate:0},y=(0,c.O)((e=_,t)=>t.type===i.hGY?{eligibilityHolds:(0,d.A)(t.eligibilityHolds),eligibilityWarnings:(0,d.A)(t.eligibilityWarnings,(0,g.A)("name")),lastUpdate:t.lastUpdate}:e),E=(0,c.O)((e=null,t)=>{switch(t.type){case i.hGY:return e||p.qC.INQUIRING;case n.SS:return p.qC.START;case n.NZ:return p.qC.FAILURE;case i.Xme:return t.status;case n.lS:return"complete"===t.status?p.qC.COMPLETE:e;case i.z2q:return"An invalid transfer ID was passed."===t.error?p.qC.NONE:p.qC.REQUEST_FAILURE}return e}),I=(0,l.H)({eligibility:y,status:E,fetchingStatus:(e=!1,t)=>{switch(t.type){case i.C3f:return!0;case i.Xme:case i.z2q:return!1;default:return e}}}),O=(0,u.N)({type:"object",patternProperties:{"^\\d+$":{type:"object",properties:{eligibility:{type:"object",properties:{lastUpdate:{type:"number",minimum:0},eligibilityHolds:{type:"array",items:{type:"string"}},eligibilityWarnings:{type:"array",items:{type:"object",properties:{name:{type:"string"},description:{type:"string"},supportUrl:{type:"string"}}}}}},status:{type:["string","null"]}}}}},(0,o.b)("siteId",I)),m=(0,r.p6)("automatedTransfer",O);(0,a.K)(["automatedTransfer"],m)},"./state/plugins/init.js":(e,t,s)=>{var a=s("./state/redux-store.ts"),r=s("../packages/state-utils/src/index.ts"),i=s("./state/utils/reducer-utils.ts"),n=s("../node_modules/lodash-es/findIndex.js"),c=s("./lib/formatting/decode-entities.ts"),l=s("./state/action-types.ts"),u=s("./state/utils/schema-utils.js"),o=s("./state/plugins/installed/status/constants.ts");function p(e={},t){switch(t.type){case l.gp8:case l.UOK:case l.sRT:case l.tj3:case l.CKd:case l.EDr:case l.p0u:return Object.assign({},e,{status:o.lH,action:t.action});case l.Ep7:case l.FXX:case l.aEG:case l.bIz:case l.Kqn:case l.UfU:case l.nb_:return Object.assign({},e,{status:o.d,action:t.action});case l.D9B:case l.ONe:case l.hiF:case l.CTy:case l.hWy:case l.dAn:case l.ctk:return Object.assign({},e,{status:o.Mw,action:t.action,error:t.error});case l.Sv3:return Object.assign({},e,{status:o.ym,action:t.action,error:t.error});case l.yps:return Object.assign({},e,{status:o._k,action:t.action});default:return e}}function d(e){return e.map(e=>g(e))}function g(e){return e.name?{...e,name:(0,c.S)(e.name)}:e}let _=(0,u.N)({type:"object",patternProperties:{"^[0-9]+$":{type:"array",items:{required:["id","slug","name","active","autoupdate"],properties:{id:{type:"string"},slug:{type:"string"},active:{type:"boolean"},name:{type:"string"},plugin_url:{type:"string"},version:{type:"string"},description:{type:"string"},author:{type:"string"},author_url:{type:"string"},network:{type:"boolean"},autoupdate:{type:"boolean"},update:{type:"object"}}}}},additionalProperties:!1},(e={},t)=>{switch(t.type){case l.rZ9:return{...e,[t.siteId]:d(t.data)};case l.bv4:return Object.fromEntries(Object.entries(t.allSitesPlugins).map(([e,t])=>[e,d(t)]));case l.Ep7:case l.FXX:case l.aEG:case l.bIz:case l.Kqn:case l.UfU:case l.Sv3:case l.nb_:case l.EbS:return function(e,t){return void 0!==e[t.siteId]?Object.assign({},e,{[t.siteId]:function(e=[],t){switch(t.type){case l.Ep7:case l.FXX:case l.aEG:case l.bIz:case l.Kqn:case l.EbS:return e.map(e=>(function(e,t){switch(t.type){case l.Ep7:case l.FXX:case l.bIz:case l.Kqn:case l.EbS:if(e.id!==t.data.id)return e;return Object.assign({},e,g(t.data));case l.aEG:if(e.id!==t.data.id)return e;return Object.assign({},e,{update:{recentlyUpdated:!0}},g(t.data));default:return e}})(e,t));case l.UfU:case l.Sv3:return[...e,g(t.data)];case l.nb_:let s=(0,n.A)(e,{id:t.pluginId});return[...e.slice(0,s),...e.slice(s+1)];default:return e}}(e[t.siteId],t)}):e}(e,t)}return e}),y=(0,i.H)({isRequesting:function(e={},t){switch(t.type){case l.XD8:return Object.assign({},e,{[t.siteId]:!0});case l.Kee:case l.b3E:return Object.assign({},e,{[t.siteId]:!1});default:return e}},isRequestingAll:function(e=!1,t){switch(t.type){case l.vr2:return!0;case l.cTK:case l.$pU:return!1;default:return e}},requestError:function(e=!1,t){switch(t.type){case l.vr2:case l.$pU:return!1;case l.cTK:return!0;default:return e}},plugins:_,status:function(e={},t){let{siteId:s}=t;switch(t.type){case l.gp8:case l.UOK:case l.sRT:case l.tj3:case l.CKd:case l.EDr:case l.p0u:case l.Ep7:case l.FXX:case l.aEG:case l.bIz:case l.Kqn:case l.UfU:case l.Sv3:case l.nb_:case l.D9B:case l.ONe:case l.hiF:case l.CTy:case l.hWy:case l.dAn:case l.ctk:case l.yps:return Object.assign({},e,{[s]:function(e={},t){let{pluginId:s}=t;switch(t.type){case l.gp8:case l.UOK:case l.sRT:case l.tj3:case l.CKd:case l.EDr:case l.p0u:case l.Ep7:case l.FXX:case l.aEG:case l.bIz:case l.Kqn:case l.UfU:case l.Sv3:case l.nb_:case l.D9B:case l.ONe:case l.hiF:case l.CTy:case l.hWy:case l.dAn:case l.ctk:case l.yps:if(void 0!==e[s])return Object.assign({},e,{[s]:p(e[s],t)});return Object.assign({},e,{[s]:p({},t)});default:return e}}(e[s],t)});case l.Xh$:{if(!t.statuses||!t.statuses.length)return e;let s=Object.entries(e).map(([e,s])=>{let a=Object.entries(s).filter(([,e])=>!t.statuses.includes(e.status));return a.length?[e,Object.fromEntries(a)]:[]}).filter(e=>e.length);return Object.fromEntries(s)}case l.G6m:return{};default:return e}}});var E=s("../node_modules/lodash-es/mapValues.js"),I=s("../node_modules/lodash-es/omit.js"),O=s("./state/utils/with-persistence.ts");let m=e=>Object.fromEntries(["name","code","error","message"].map(t=>[t,e[t]]).filter(([,e])=>void 0!==e)),T=(0,u.N)({type:"object",patternProperties:{"^[0-9]+$":{type:"array",items:{required:["slug"],properties:{name:{type:"string"},slug:{type:"string"},status:{type:"string"},error:{type:["object","string","null"]},key:{type:"null"}}}}},additionalProperties:!1},(0,O.O)((e={},t)=>{switch(t.type){case l.kqw:return Object.assign({},e,{[t.siteId]:t.data});case l.gR8:case l.w79:case l.LU:case l.OXh:case l.Fc4:if(void 0!==e[t.siteId])return Object.assign({},e,{[t.siteId]:function(e=[],t){switch(t.type){case l.kqw:return t.data;case l.gR8:case l.w79:case l.LU:case l.OXh:case l.Fc4:return e.map(e=>(function(e,t){switch(t.type){case l.gR8:case l.w79:case l.LU:case l.OXh:if(e.slug!==t.slug)return e;return Object.assign({},e,{status:f(e.status,t)});case l.Fc4:if(e.slug!==t.slug)return e;return Object.assign({},e,{status:f(e.status,t),error:t.error});default:return e}})(e,t));default:return e}}(e[t.siteId],t)});return e;default:return e}},{serialize:e=>(0,E.A)(e,e=>e.map(e=>(e.error&&(e={...e,error:m(e.error)}),(0,I.A)(e,"key"))))}));function f(e,t){switch(t.type){case l.gR8:return"install";case l.w79:return"activate";case l.LU:return"configure";case l.OXh:return"done";default:return e||"wait"}}let S=(0,i.H)({isRequesting:function(e={},t){switch(t.type){case l.P6m:return Object.assign({},e,{[t.siteId]:!0});case l.kqw:return Object.assign({},e,{[t.siteId]:!1});default:return e}},hasRequested:function(e={},t){return t.type===l.kqw?Object.assign({},e,{[t.siteId]:!0}):e},plugins:T});var h=s("./state/utils/keyed-reducer.ts");let A=(0,h.b)("siteId",(e={},t)=>{switch(t.type){case l.Yg$:return null;case l.gHT:{let{pluginId:e}=t;return e}case l.u2O:case l.RNB:return null;case l.Xme:{let{uploadedPluginId:e}=t;return e}}return e}),b=(0,h.b)("siteId",(e={},t)=>{switch(t.type){case l.RNB:{let{error:e}=t;return e}case l.Yg$:case l.u2O:case l.gHT:return null}return e}),N=(0,h.b)("siteId",(e={},t)=>{switch(t.type){case l.wdD:{let{progress:e}=t;return e}case l.Yg$:case l.u2O:case l.RNB:return 0}return e}),j=(0,h.b)("siteId",(e={},t)=>{switch(t.type){case l.Yg$:return!0;case l.gHT:case l.RNB:case l.u2O:return!1;case l.o7s:return!0;case l.Xme:{let{status:e}=t;return"complete"!==e&&"reverted"!==e}}return e}),R=(0,i.H)({uploadedPluginId:A,uploadError:b,progressPercent:N,inProgress:j});function U(e={},t,s){return Object.assign({},e,{[t]:Object.assign({},e[t],s)})}let w=(0,O.O)(function(e={},t){let{type:s,pluginSlug:a}=t;return s===l.Noo?t.data?U(e,a,Object.assign({fetched:!0,wporg:!0},t.data)):U(e,a,Object.assign({fetched:!1,wporg:!1,error:t.error})):e}),C=(0,i.H)({fetchingItems:function(e={},t){switch(t.type){case l.FC2:return Object.assign({},e,{[t.pluginSlug]:!0});case l.Noo:return Object.assign({},e,{[t.pluginSlug]:!1})}return e},fetchingLists:function(e={},t){switch(t.type){case l.iDx:case l.SVB:if(t.category)return{...e,category:{...e.category,[t.category]:t.type===l.iDx}};if(t.searchTerm)return{...e,search:{...e.search,[t.searchTerm]:t.type===l.iDx}}}return e},items:w,listsPagination:function(e={},t){let{category:s,pagination:a}=t;return t.type===l.SVB&&a&&s?{...e,category:{...e.category,[s]:a}}:e}}),L=(0,i.H)({wporg:C,premium:S,installed:y,upload:R,lastVisited:function(e={slug:"",listName:""},t){return t.type===l.GIf?t.payload:e}}),P=(0,r.p6)("plugins",L);(0,a.K)(["plugins"],P)},"./state/plugins/installed/status/constants.ts":(e,t,s)=>{s.d(t,{GZ:()=>l,Mw:()=>n,_k:()=>c,d:()=>r,lH:()=>a,ym:()=>i});let a="inProgress",r="completed",i="incompleted",n="error",c="up-to-date",l={ACTIVE:1,INACTIVE:2,UPDATE:3,AUTOUPDATE_ENABLED:4,AUTOUPDATE_DISABLED:5}},"./state/plugins/upload/actions.js":(e,t,s)=>{s.d(t,{aY:()=>O,mq:()=>E,Zp:()=>I,VW:()=>y,Hs:()=>_});var a=s("./state/action-types.ts"),r=s("../packages/i18n-calypso/src/index.js"),i=s("../node_modules/lodash-es/find.js"),n=s("../node_modules/lodash-es/includes.js"),c=s("./lib/plugins/constants.js"),l=s("./state/analytics/actions/record.js"),u=s("./state/data-layer/handler-registry.js"),o=s("./state/data-layer/wpcom-http/actions.js"),p=s("./state/data-layer/wpcom-http/utils.js"),d=s("./state/notices/actions.ts");let g=e=>{let t={exists:(0,r.Tl)("This plugin is already installed on your site."),"too large":(0,r.Tl)("The plugin zip file must be smaller than 10MB."),incompatible:(0,r.Tl)("The uploaded file is not a compatible plugin."),unsupported_mime_type:(0,r.Tl)("The uploaded file is not a valid zip."),plugin_malicious:(0,r.Tl)("The uploaded file is identified as malicious.")},s=`${e.error}${e.message}`.toLowerCase(),a=(0,i.A)(t,(e,t)=>(0,n.A)(s,t));return a?(0,d.tg)(a):e.error?(0,d.tg)((0,r.Tl)("Upload problem: %(error)s.",{args:{error:e.error}})):(0,d.tg)((0,r.Tl)("Problem installing the plugin."))};function _(e,t){return{type:a.Yg$,siteId:e,file:t}}function y(e,t){return{type:a.wdD,siteId:e,progress:t}}function E(e,t){return{type:a.gHT,siteId:e,pluginId:t}}function I(e,t){return{type:a.RNB,siteId:e,error:t}}function O(e){return{type:a.u2O,siteId:e}}(0,u.vZ)("state/data-layer/wpcom/sites/plugins/new/index.js",{[a.Yg$]:[(0,p.wH)({fetch:e=>{let{siteId:t,file:s}=e;return[(0,l.Oy)("calypso_plugin_upload"),(0,o.L)({method:"POST",path:`/sites/${t}/plugins/new`,apiVersion:"1",formData:[["zip[]",s]]},e)]},onSuccess:({siteId:e},t)=>s=>{let{slug:r}=t;s((0,l.Oy)("calypso_plugin_upload_complete",{plugin_id:r})),s(E(e,r)),s({type:a.UfU,action:c.ou,siteId:e,pluginId:t.id,data:t})},onError:({siteId:e},t)=>[(0,l.Oy)("calypso_plugin_upload_error",{error_code:t.error,error_message:t.message}),g(t),I(e,t)],onProgress:({siteId:e},{loaded:t,total:s})=>y(e,s?t/s*100:s)})]}),s("./state/plugins/init.js")},"./state/selectors/is-unlaunched-site.js":(e,t,s)=>{s.d(t,{A:()=>r});var a=s("./state/selectors/get-raw-site.ts");function r(e,t){let s=(0,a.A)(e,t);return s?.launch_status==="unlaunched"}}}]);